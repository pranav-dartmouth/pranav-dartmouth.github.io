<!DOCTYPE html>
<html>
  <head>
      <title>Food Production in Louisville!</title>
      <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
      <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>'
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>

      
      <style>
          body {
            background-color: #E2DFCB;
		  font-family: Arial, sans-serif;
          }

	       .navigation {
				background-color: #A6674C;
				top: 0;
				left: 0;
				margin: 0;
				padding: 0;
				position: fixed;
				vertical-align: top;
				width: 100%;
				display: flex;
				justify-content: space-between;
				z-index: 3;
			}
				
			.navigationleftside {
				list-style-type: none;
			}

			.navigationrightside {
				list-style-type: none;
				display: flex;
			}

			nav a {
				color: white;
				text-decoration: none;
				padding: 10px;
			}

			nav a:hover {
				font-weight: bold;

			}

			nav a:visited {
				color: white;
				text-decoration: none;
				font-weight: normal;
			}

			nav a:active {
				font-weight: bold;
			}

          h1 {
            text-align: center;
          }
          #map, #map1 {
              height: 400px;
              margin-right: 20px;
    		margin-left: 20px;
		  z-index: 1;
    		
            
          }


	      #map2 {
              height: 400px;
		margin-right: 20px;
    		margin-left: 20px; 
		      z-index: 1;
              
             
             
            
          }

	      .buttontext {
		margin-left: auto;
		margin-right: auto;
		text-align: center;
		display: flex;
		justify-content: center;
	}

	      button {
		background-color: white; 
		border: solid 2px;
		font-weight: bold;
		font-size: 15px;
		padding-top: 10px;
		padding-bottom: 10px;
		padding-right: 10px;
		padding-left: 10px;
		margin-bottom: 5px;
		margin-right: auto;
		margin-left: auto;
		border-radius: 15px;
		text-align: center;
		text-decoration: none;
		width: 200px;
			}

	      #toggleCompanies {
		margin-top: 5px;
		border-color: blue;
		color: blue;
	      }

	      #toggleCSAs {
		margin-top: 5px;
		border-color: blue;
		color: blue;
	      }

	        #toggleCSACensusTracts {
		margin-top: 5px;
		border-color: blue;
		color: blue;
	      }

	        #toggleUrbanFarms {
		margin-top: 5px;
		border-color: green;
		color: green;
	      }

	        #toggleUrbanFarmHeatmap {
		margin-top: 5px;
		border-color: green;
		color: green;
	      }

	       #toggleUrbanFarmHeatmap {
		margin-top: 5px;
		border-color: green;
		color: green;
	      }

	      #toggleUrbanFarmsCensusTracts {
		margin-top: 5px;
		border-color: green;
		color: green;
	      }

	      .section, #firstsection {
		      padding-top: 30px;
		      margin-bottom: 30px;
		      
	      }

	      .section {
		      background-color: white;
		      margin-right: auto;
		      margin-left: auto;
		      width: 50%;
		      border-radius: 20px;
		      padding-bottom: 30px;
	      }

	      

	      h1, h3 {
		      text-align: center;
	      }

	      .part {
		      
    box-sizing: border-box;
    padding-left: 20px;
    padding-right: 20px;
	      }

	      li {
		      text-align: center;
		      list-style-position: inside;
	      }

	      .component {
		      z-index: -3;
	      }

	      #csaimage, #communitygardenimage {
		margin-right: auto;
		      margin-left: auto;
		      display: block;
		      height: 325px;
		      width: 50%;
	      }

		      figcaption {
			      font-size: xx-small;
			      text-align: center;
		      }

	       .legend {
		      line-height: 18px;
		      color: #555;

	      }

	      .legend i {
		      width: 18px;
		      height: 18px;
		      float: left;
		      margin-right: 8px;
		      opacity: 0.7;
	      }

	      

	      .info {
		      padding: 6px 8px;
		     
		      background: white;
		      background: rgba(255,255,255,0.8);
		      box-shadow: 0 0 15px rgba(0,0,0,0.2);
		      border-radius: 5px;
	      }

	      .info h4 {
		      margin: 0 0 5px;
		      color: #777;
	      }

	      .info1 {
		      padding: 6px 8px;
		     
		      background: white;
		      background: rgba(255,255,255,0.8);
		      box-shadow: 0 0 15px rgba(0,0,0,0.2);
		      border-radius: 5px;
	      }

	      .info1 h4 {
		      margin: 0 0 5px;
		      color: #777;
	      }

	      
		      
	    
        
      </style>
      
  </head>
  <body>
	   <nav>
			<div class="navigation">
			<div>
				<ul class="navigationleftside">
					<li><a href="louisvillefoodsystemfinal.html">Louisville's Food System</a></li>
				</ul>
			</div>
			<div>
				<ul class="navigationrightside">
					<li><a href="overview.html" class="navlinks">Overview</a></li>
					<li><a href="production.html" class="navlinks">Production</a></li>
					<li><a href="manufacturing.html" class="navlinks">Manufacturing</a></li>
					<li><a href="retail.html" class="navlinks">Retail</a></li>
					<li><a href="reform.html" class="navlinks">Reform</a></li>
				</ul>
			</div>
			</div>
		</nav>
	  <div class="component">
	<div id="firstsection">
      <h1>Food Production in Louisville</h1>
	</div>
	<div class="section">
		<h3>The Local is Global</h3>
		<p class="part">Most of the food that ends up in Louisville's consumer market isn't actually produced within the city itself, but rather transported via global and national supply chains who in turn source their produce from innumerable (primarily agricultural) enterprises. In this way, Louisville's food system is implicated in the inherent inequalities characterizing broader food systems.<p>
			<p class="part">Mapped below are the headquarters of some of the <a href="https://agrolearner.com/biggest-agricultural-companies-in-usa/" target="_blank">largest agricultural corporations</a> that likely play a significant role in food production for Louisville, along with some examples of the inequality inherent to the production phase of the world's (and, by extension, Louisville's) food system: </p>
		<!-- <ol class="part" class="list">
			<li>Cargill</li>
			<li>Syngenta</li>
			<li>Tyson Foods</li>
			<li>BASF</li>
			<li>Nutrien</li>
		</ol>
		--> 

		<div id="map"></div>
		<div class="buttontext"><button id="toggleCompanies" hidden>Companies</button></div>
	</div>
		<div class="section">
		<h3>Louisville's Agricultural Sector</h3>
		<p class="part">Despite the fact that most of Louisville's food is not grown within the city itself, there is a little bit of internal food production. According to <a href="https://www.nass.usda.gov/Publications/AgCensus/2017/Online_Resources/Ag_Census_Web_Maps/index.php" target="_blank">the United States Department of Agriculture's 2017 Census</a>, Jefferson County, Kentucky is home to 343 farms with an average acreage of 59 acres per farm. <br><br>Two of the most prominent forms of agriculture that have became popularized in recent years, particularly in an urban context like Louisville, are <span style="font-weight:bold;">community-supported agriculture</span> and <span style="font-weight:bold;">community gardening</span>. </p>
		</div>

		<div class="section">	
  
      		<h3>Community-Supported Agriculture</h3>
		<p class="part">Community-supported agriculture (known as CSA for short) is a system that allows consumers to subscribe to and support a particular farm of their choosing, in turn being able to share in its produce on a weekly or near-weekly basis. It is a system that is supposed to <a href="https://www.delish.com/food/a36554872/what-is-a-csa/" target="_blank">increase the proximity between food producers and consumers</a> by allowing "both the eater and the grower share the risks and rewards from what comes out of the ground."<br></p>
			<figure><img src="csapicture.png" alt="Picture of Barr Farms CSA, Kentucky" id="csaimage"><figcaption>Image from: <a href="https://www.barrfarmsky.com/" target="_blank">Barr Farms</a></figcaption></figure>
			<p class="part">It has grown in popularity across the U.S., to the point where there are more than 7,000 farms that practice the CSA model all across the country. Some of the <a href="https://www.canr.msu.edu/news/principles_and_benefits_of_community_supported_agriculture#:~:text=Consumers%20experience%20many%20benefits%20when,value%20and%20stays%20fresher%20longer" target="_blank">factors</a> behind the newfound popularization of CSAs include: the impetus to eat healthy, the desire to "support local farmers," the perception that such a model could be more sustainable and better for the environment, and the overall notion on the part of both consumers and producers that it's important to get to know where their food is coming from/to.<br><br>Yet CSAs, despite all of their popularization and supposed benefits, have been unevenly distributed with respect to axes like income and race. Because participating in a CSA program requires paying upfront for the farmer's inputs and sharing in the farmer's own losses, CSA members tend to overwhelmingly skew towards privileged sectors of society. That is corroborated by research in <a href="https://www.sciencedirect.com/science/article/pii/S2352340918314380#tblt0015fn6366" target="_blank">California</a> and in <a href="https://www.montclair.edu/profilepages/media/1853/user/Pole_and_Kumar.pdf" target="_blank">New York</a>.<br></p>
			<p class="part"><span style="font-weight:bold;text-align:center;">But is this inequality characterizing CSAs present in Louisville too?</span></p>
		
		<div id="map1" class="part"></div>
     		<div class="buttontext"><button id="toggleCSAs" hidden>CSAs</button></div><br>
		<div class="buttontext"><button id="toggleCSACensusTracts" hidden>Census Tracts</button></div><br>
		<p class="part">In this map (where you can toggle Louisville's CSAs and census tracts), you can see how nearly all farms with a CSA program are in census tracts with low poor and minority populations. In terms of poverty in particular, it is notable that none of the census tracts with CSAs have a significant percentage of their population in poverty.<br><br>Based on this, CSAs are <span style="font-weight:bold;">unequally distributed in Louisville</span> and are likely mostly accessible to the most privileged residents of the city.</p>
		</div>
	  <div class="section">	
		  <h3>Community Gardening</h3>
		  <p class="part">Community gardening is the practice wherein a small or large group of people, particularly in urban areas, cultivate and harvest produce from a shared gardening space. It is supposed to allow individuals to grow fresh produce on their own plot of land and to induce a degree of localization within the food supply chain.<br></p>
		  <figure><img src="communitygardenimage.jpeg" alt="Image of community garden" id="communitygardenimage"><figcaption>Image from: <a href="https://louisville.edu/sustainability/operations/garden-commons" target="_blank">University of Louisville Sustainability</a></figcaption></figure>
			 <p class="part">Some of the oft-cited benefits of community gardens and reasons people partake in it <a href="http://lagardencouncil.org/benefits-of-community-gardening/" target="_blank">include</a>: beautifying the urban landscape, promoting a healthier lifestyle, increasing wellness, and, above all, rupturing the distance between urbanites and the food production process.<br><br>Yet, as with community supported agriculture, there does seem to be a degree of privilege and financial security involved in community gardening, reproducing <a href="https://journals.sagepub.com/doi/full/10.1177/0309132513512542">economic inequalities</a>. The fact that underprivileged urbanites without the time and capital to maintain upkeep of a garden are often excluded from community gardening has been growingly recognized in research in contexts beyond Louisville, like <a href=https://onlinelibrary.wiley.com/doi/full/10.1111/anti.12098?casa_token=Hyz7y1RIHUAAAAAA%3AgxeiMCzqPBnQzwxwKj7gqvoypF5wEIVEWuQ4KKRNKi8TlZ92nYemMJ9FQbqM7OnBIGLj0sg1eFGxPUg" target="_blank">New York</a> and <a href="https://journals.sagepub.com/doi/full/10.1177/00943061221142074ff?casa_token=Qww8Ybfsf9YAAAAA:fRq_Y7AuRD7YUEZHGjOSNYSRuvSRpf95e-AI5Xqbq0TQE-dhZX88Kz39_KMwFuov92h3R3o2ub8lrg" target="_blank">Massachusetts</a>.<br></p>
		  <p class="part"><span style="font-weight:bold;text-align:center;">Is the general inaccessibility of community gardening for underprivileged urbanites being replicated in Louisville?</span></p>
    <div id="map2" class="part"></div> <!-- Source for help on this: W3Schools -->
     <div class="buttontext"><button id="toggleUrbanFarms" hidden>Urban Farms</button></div>
		
	  
<div class="buttontext"><button id="toggleUrbanFarmHeatmap" hidden>Urban Farms Heatmap</button></div>
		  <div class="buttontext"><button id="toggleUrbanFarmsCensusTracts" hidden>Census Tracts</button></div><br>
<p class="part">In the map, you can see how there doesn't seem to be a clear spatial bias with regard to how community gardens are distributed throughout the city. In fact, the census tract with the most gardens (Census Tract 62) has a high rate of poverty (20%), a high proportion of Black/Hispanic residents (65%), and a high percentage of people who receive SNAP benefits (9%). Other census tracts with similar patterns in the western part of Louisville include Census Tracts 4, 23, 51, and 56.<br><br>
Yet, despite the fact that community gardening doesn't seem to be unequally spatialized in the same way that CSAs do, that doesn't mean there are not inequalities of access to them along axes of race, income, etc. In fact, as <a href="https://www.academia.edu/10210555/Garden_With_Neighbors_Louisvilles_Potential_to_Promote_Food_Security_Through_Community_Gardening" target="_blank">prior research</a> has shown, the reason why urban gardens may appear to be overprevalent in poorer, minority urban communities may be due to their usage by gentrifiers, rather than by the original inhabitants of those communities.</p>  
	  </div>
	  </div>


      <script>
        
          var companiesLayer;
	      var companiesVisible = true;
	      var csasLayer;
          var csasVisible = true;
	    var  csascensustractsLayer;
	    var  csascensustractsVisible = true;
         var urbanfarmsLayer;
          var urbanfarmsVisible = true;
	var urbanfarmheatmapLayer;
	      var urbanfarmheatmapVisible = true;
	      var urbanfarmscensustractsLayer;
          var urbanfarmscensustractsVisible = true;
	      
	  var OpenStreetMap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '© <a href="www.openstreetmap.com/copyright">OpenStreetMap</a>'});

           var CartoDB_DarkMatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 20
});

          

          var USGS_USImageryTopo = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}', {
	        maxZoom: 20,
	        attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
          });

	
	      var Esri_WorldGrayCanvas = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',
	maxZoom: 16
});

	      var Esri_WorldTerrain = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS',
	maxZoom: 13
});

	      var Esri_WorldShadedRelief = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri',
	maxZoom: 13
});

	      var OpenStreetMap1 = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '© <a href="www.openstreetmap.com/copyright">OpenStreetMap</a>'});

           var CartoDB_DarkMatter1 = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 20
});

          

          var USGS_USImageryTopo1 = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}', {
	        maxZoom: 20,
	        attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
          });

	
	      var Esri_WorldGrayCanvas1 = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',
	maxZoom: 16
});

	      var Esri_WorldTerrain1 = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS',
	maxZoom: 13
});

	      var Esri_WorldShadedRelief1 = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri',
	maxZoom: 13
});

	         var OpenStreetMap2 = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '© <a href="www.openstreetmap.com/copyright">OpenStreetMap</a>'});

           var CartoDB_DarkMatter2 = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 20
});

          

          var USGS_USImageryTopo2 = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}', {
	        maxZoom: 20,
	        attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
          });

	
	      var Esri_WorldGrayCanvas2 = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',
	maxZoom: 16
});

	      var Esri_WorldTerrain2 = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS',
	maxZoom: 13
});

	      var Esri_WorldShadedRelief2 = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri',
	maxZoom: 13
});

	      

          var baseMaps = {"OSM" : OpenStreetMap,
			  "CTBD" : CartoDB_DarkMatter,
                          "USGS" : USGS_USImageryTopo,
			  "EWGC": Esri_WorldGrayCanvas,
			  "EWT": Esri_WorldTerrain,
			  "EWSR": Esri_WorldShadedRelief
                         };

	      
          var baseMaps1 = {"OSM" : OpenStreetMap1,
			  "CTBD" : CartoDB_DarkMatter1,
                          "USGS" : USGS_USImageryTopo1,
			  "EWGC": Esri_WorldGrayCanvas1,
			  "EWT": Esri_WorldTerrain1,
			  "EWSR": Esri_WorldShadedRelief1
                         };

	      
	     var baseMaps2 = {"OSM" : OpenStreetMap2,
			  "CTBD" : CartoDB_DarkMatter2,
                          "USGS" : USGS_USImageryTopo2,
			  "EWGC": Esri_WorldGrayCanvas2,
			  "EWT": Esri_WorldTerrain2,
			  "EWSR": Esri_WorldShadedRelief2
                         };   

	     

	 function csaSymbology(feature) {
                var count = feature.properties.NUMPOINTS;
		var polygoncolor;
		 var polygonopacity;

		if (count == 0) {
			polygoncolor = "#FFFFFF";
			polygonopacity = 0;

		}

		if (count == 1) {
			polygoncolor = "#a6bddb";
			polygonopacity = 1;

		}

		return {
		 fillColor: polygoncolor,
		color: polygoncolor,
		fillOpacity: polygonopacity,
		opacity: polygonopacity
			
	       };	       
	      }

	        function getColorcsas(d) {
		 return     d > 0 ? "#a6bddb" : 
		       		
			      "#ffffff";
	      }

	      function urbanfarmsSymbology(feature) {
                var count = feature.properties.NUMPOINTS;
		var polygoncolor;
		var polygonopacity;

		if (count >= 0) {
			polygoncolor = "#FFFFFF";
			polygonopacity = 0;

		}

		if (count >= 1) {
			polygoncolor = "#e5f5f9";
			polygonopacity = 1;

		}

		if (count >= 2) {
			polygoncolor = "#99d8c9";
			polygonopacity = 1;
		}

		if (count >= 3) {
			polygoncolor = "#2ca25f";
			polygonopacity = 1;
		}

		return {
		 fillColor: polygoncolor,
		color: polygoncolor,
		fillOpacity: polygonopacity,
		opacity: polygonopacity
			
	       };	       
	      }

	       function getColorurbanfarms(d) {
		 return     d > 2 ? "#2ca25f" : 
		       	    d > 1 ? "#99d8c9" :
			    d > 0 ? "#e5f5f9" :
			      "#FFFFFF"
	      }

	       var info = L.control({position: "topleft"});

info.onAdd = function (map1) {
    this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
    this.update();
    return this._div;
};

info.update = function (props) {
    this._div.innerHTML = '<h3>Number of CSAs</h3>' +  (props ?
        '<b>' + props.NAME1 + '</b><br />' + Math.round(props.NUMPOINTS) + ' CSAs<br />' + Math.round(props.pctpov) + '% of the population in poverty<br />' + Math.round(parseFloat(props.pctblack) + parseFloat(props.pcthispani)) + '% of the population is Black/Hispanic<br />' + Math.round(props.pctSNAP) + '% of the population on SNAP'
					: 'Hover over a census tract');
};

	      function highlightFeaturecsas(e) {
    var layer = e.target;

    layer.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
    });

    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        layer.bringToFront();
    }
info.update(layer.feature.properties);
}
	     
	      
	      function resetHighlightcsas(e) {
    csascensustractsLayer.resetStyle(e.target);
		         info.update();

		      
}

	      

	      function zoomToFeaturecsas(e) {
    map.fitBounds(e.target.getBounds());
}

	      function onEachFeaturecsas(feature, layer) {
    layer.on({
        mouseover: highlightFeaturecsas,
        mouseout: resetHighlightcsas,
        click: zoomToFeaturecsas
    });

		      
}

	      var info1 = L.control({position: "topleft"});

info1.onAdd = function (map2) {
    this._div = L.DomUtil.create('div', 'info1'); // create a div with a class "info"
    this.update();
    return this._div;
};

info1.update = function (props) {
    this._div.innerHTML = '<h3>Number of Community Gardens</h3>' +  (props ?
        '<b>' + props.NAME1 + '</b><br />' + Math.round(props.NUMPOINTS) + ' community gardens<br />' + Math.round(props.pctpov) + '% poor<br />' + Math.round(parseFloat(props.pctblack) + parseFloat(props.pcthispani)) + '% Black/Hispanic<br />' + Math.round(props.pctSNAP) + '% on SNAP'
					: 'Hover over a census tract');
};

	      function highlightFeatureurbanfarms(e) {
    var layer1 = e.target;

    layer1.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
    });

    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
        layer1.bringToFront();
    }
info1.update(layer1.feature.properties);
}
	     
	      
	      function resetHighlighturbanfarms(e) {
    urbanfarmscensustractsLayer.resetStyle(e.target);
		         info1.update();

		      
}

	      

	      function zoomToFeatureurbanfarms(e) {
    map.fitBounds(e.target.getBounds());
}

	      function onEachFeatureurbanfarms(feature, layer) {
    layer.on({
        mouseover: highlightFeatureurbanfarms,
        mouseout: resetHighlighturbanfarms,
        click: zoomToFeatureurbanfarms
    });

		      
}

	        var response = $.ajax({
            url: "agriculturalcompanies.geojson",
            dataType: "json",
            success: console.log("Company data loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	    var map = L.map('map', {
		  center: [40, -35],
		  zoom: 2,
		  layers: [Esri_WorldTerrain]
	  });

	       L.control.layers(baseMaps).addTo(map);

	      


	      

          $.when(response).done(function() {
   
            var companiesLayer = L.geoJson(response.responseJSON, {
              
                     onEachFeature: function(feature, layer) {
                            layer.bindPopup("<b>Company: " + 
                            feature.properties.Name + "</b><br>" + feature.properties.Name + ", " + feature.properties.Description + ", " + feature.properties.Issue + "<br>"); 

                       },

                      pointToLayer: function (feature, latlng) { 
                          return L.circleMarker(latlng, {
                            
                         
                          weight: 1,
                          opacity: 1,
			radius: 7,
                          fillOpacity: 1,
                            fillColor: "blue",
                            color: "blue"
              });
              },
            }).addTo(map);

             $("#toggleCompanies").show();

           $("#toggleCompanies").click( function() {
              if (companiesVisible) {
                    companiesVisible = false;
                    companiesLayer.removeFrom(map);
              }

              else {
                  companiesVisible = true;
                   companiesLayer.addTo(map);
              }
            });

          });

                  var response1 = $.ajax({
            url: "CSAs.geojson",
            dataType: "json",
            success: console.log("CSA data loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	      var map1 = L.map('map1', {
		  center: [38.2527, -85.7585],
		  zoom: 10,
		  layers: [OpenStreetMap1]
	  });

	 L.control.layers(baseMaps1).addTo(map1);

	       var legend = L.control({position: 'bottomright'});

	      legend.onAdd = function (map1) {

		      var div = L.DomUtil.create('div', 'info legend'),
			      grades = [0, 1],
			      labels = [];

		      for (var i = 0; i < grades.length; i++) {
			      div.innerHTML +=
			'<i style="background:' + getColorcsas(grades[i]) + '"></i> ' +
				      (grades[i] ? grades[i] + '<br>' : '<br>');
		      }

		      return div;

	      };

	      legend.addTo(map1);


          $.when(response1).done(function() {
   
            var csasLayer = L.geoJson(response1.responseJSON, {
              
                     onEachFeature: function(feature, layer) {
                            layer.bindPopup("<b>CSA: " + 
                            feature.properties.Name + "</b>"); 

                       },

                      pointToLayer: function (feature, latlng) { 
                          return L.circleMarker(latlng, {
                            
                         
                          weight: 1,
                          opacity: 1,
			radius: 3,
                          fillOpacity: 1,
                            fillColor: "blue",
                            color: "blue"
              });
              },
            }).addTo(map1);

             $("#toggleCSAs").show();

           $("#toggleCSAs").click( function() {
              if (csasVisible) {
                    csasVisible = false;
                    csasLayer.removeFrom(map1);
              }

              else {
                  csasVisible = true;
                   csasLayer.addTo(map1);
              }
            });

          });

   var response2 = $.ajax({
            url: "csascensustracts.geojson",
            dataType: "json",
            success: console.log("CSA census data loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	    

          $.when(response2).done(function() {
   
            csascensustractsLayer = L.geoJson(response2.responseJSON, {

		    style: csaSymbology,
              
                      onEachFeature: onEachFeaturecsas
            }).addTo(map1);
info.addTo(map1);

             $("#toggleCSACensusTracts").show();

           $("#toggleCSACensusTracts").click( function() {
              if (csascensustractsVisible) {
                    csascensustractsVisible = false;
                    csascensustractsLayer.removeFrom(map1);
              }

              else {
                  csascensustractsVisible = true;
                   csascensustractsLayer.addTo(map1);
              }
            });

          });
          var response3 = $.ajax({
            url: "urbanfarms2final.geojson",
            dataType: "json",
            success: console.log("Urban farm data loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	       var map2 = L.map('map2', {
		  center: [38.2527, -85.7585],
		  zoom: 10,
		  layers: [OpenStreetMap2]
	  });

	       L.control.layers(baseMaps2).addTo(map2);

	      var legend1 = L.control({position: 'bottomright'});

	      legend1.onAdd = function (map2) {

		      var div = L.DomUtil.create('div', 'info legend'),
			      grades = [0, 1, 2, 3],
			      labels = [];

		      for (var i = 0; i < grades.length; i++) {
			      div.innerHTML +=
			'<i style="background:' + getColorurbanfarms(grades[i]) + '"></i> ' +
				      (grades[i] ? grades[i] + '<br>' : '<br>');
		      }

		      return div;

	      };

	      legend1.addTo(map2);
	      

	      var urbanfarmscsv = Array();

          $.when(response3).done(function() {
   
            var urbanfarmsLayer = L.geoJson(response3.responseJSON, {

		   
              
                     onEachFeature: function(feature, layer) {
                            layer.bindPopup("<b>Urban Farm: " + 
                            feature.properties.Name + "</b>"); 
			    urbanfarmscsv.push([feature.geometry.coordinates[1], feature.geometry.coordinates[0], 1]);

                       },

                      pointToLayer: function (feature, latlng) { 
                          return L.circleMarker(latlng, {
                            
                         
                          weight: 1,
                          opacity: 1,
                          fillOpacity: 1,
				  radius: 3,
                            fillColor: "#3BB143",
                            color: "#3BB143"
              });
              },
            }).addTo(map2);

		     console.log(urbanfarmscsv);

      urbanfarmheatmapLayer = L.heatLayer(urbanfarmscsv, {
        radius: 25
      }).addTo(map2);


            $("#toggleUrbanFarms").show();

           $("#toggleUrbanFarms").click( function() {
              if (urbanfarmsVisible) {
                    urbanfarmsVisible = false;
                    urbanfarmsLayer.removeFrom(map2);
              }

              else {
                  urbanfarmsVisible = true;
                   urbanfarmsLayer.addTo(map2);
              }
            });

            $("#toggleUrbanFarmHeatmap").show();

           $("#toggleUrbanFarmHeatmap").click( function() {
              if (urbanfarmheatmapVisible) {
                    urbanfarmheatmapVisible = false;
                    urbanfarmheatmapLayer.removeFrom(map2);
              }

              else {
                  urbanfarmheatmapVisible = true;
                   urbanfarmheatmapLayer.addTo(map2);
              }
            });
	  });


	     var response4 = $.ajax({
            url: "gardensbycensustract.geojson",
            dataType: "json",
            success: console.log("Urban farms by census tract loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	     

          $.when(response4).done(function() {
   
            urbanfarmscensustractsLayer = L.geoJson(response4.responseJSON, {

		    style: urbanfarmsSymbology, 
              
                     onEachFeature: onEachFeatureurbanfarms

                    
            }).addTo(map2);

info1.addTo(map2);



		  
		   $("#toggleUrbanFarmsCensusTracts").show();

           $("#toggleUrbanFarmsCensusTracts").click( function() {
              if (urbanfarmscensustractsVisible) {
                    urbanfarmscensustractsVisible = false;
                    urbanfarmscensustractsLayer.removeFrom(map2);
              }

              else {
                  urbanfarmscensustractsVisible = true;
                   urbanfarmscensustractsLayer.addTo(map2);
              }
            });
	  });

	      

       

	    
   
              
      </script>
  </body>
</html>


