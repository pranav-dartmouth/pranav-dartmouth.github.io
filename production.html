<!DOCTYPE html>
<html>
  <head>
      <title>Food Production in Louisville!</title>
      <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
      <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>'
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>

      
      <style>
          body {
            background-color: #E2DFCB;
		  font-family: Arial, sans-serif;
          }

	       .navigation {
				background-color: #A6674C;
				top: 0;
				left: 0;
				margin: 0;
				padding: 0;
				position: fixed;
				vertical-align: top;
				width: 100%;
				display: flex;
				justify-content: space-between;
				z-index: 3;
			}
				
			.navigationleftside {
				list-style-type: none;
			}

			.navigationrightside {
				list-style-type: none;
				display: flex;
			}

			nav a {
				color: white;
				text-decoration: none;
				padding: 10px;
			}

			nav a:hover {
				font-weight: bold;

			}

			nav a:visited {
				color: white;
				text-decoration: none;
				font-weight: normal;
			}

			nav a:active {
				font-weight: bold;
			}

          h1 {
            text-align: center;
          }
          #map, #map1 {
              height: 400px;
              margin-right: 20px;
    		margin-left: 20px;
		  z-index: 1;
    		
            
          }


	      #map2 {
              height: 400px;
		margin-right: 20px;
    		margin-left: 20px; 
		      z-index: 1;
              
             
             
            
          }

	      .buttontext {
		margin-left: auto;
		margin-right: auto;
		text-align: center;
		display: flex;
		justify-content: center;
	}

	      button {
		background-color: white; 
		border: solid 2px;
		font-weight: bold;
		font-size: 15px;
		padding-top: 10px;
		padding-bottom: 10px;
		padding-right: 10px;
		padding-left: 10px;
		margin-bottom: 5px;
		margin-right: auto;
		margin-left: auto;
		border-radius: 15px;
		text-align: center;
		text-decoration: none;
		width: 200px;
			}

	      #toggleCompanies {
		margin-top: 5px;
		border-color: blue;
		color: blue;
	      }

	      #toggleCSAs {
		margin-top: 5px;
		border-color: blue;
		color: blue;
	      }

	        #toggleCSACensusTracts {
		margin-top: 5px;
		border-color: blue;
		color: blue;
	      }

	        #toggleUrbanFarms {
		margin-top: 5px;
		border-color: green;
		color: green;
	      }

	        #toggleUrbanFarmHeatmap {
		margin-top: 5px;
		border-color: green;
		color: green;
	      }

	       #toggleUrbanFarmHeatmap {
		margin-top: 5px;
		border-color: green;
		color: green;
	      }

	      #toggleUrbanFarmsCensusTracts {
		margin-top: 5px;
		border-color: green;
		color: green;
	      }

	      .section, #firstsection {
		      padding-top: 30px;
		      margin-bottom: 30px;
		      
	      }

	      .section {
		      background-color: white;
		      margin-right: auto;
		      margin-left: auto;
		      width: 50%;
		      border-radius: 20px;
		      padding-bottom: 30px;
	      }

	      

	      h1, h3 {
		      text-align: center;
	      }

	      .part {
		      
    box-sizing: border-box;
    padding-left: 20px;
    padding-right: 20px;
	      }

	      li {
		      text-align: center;
		      list-style-position: inside;
	      }

	      .component {
		      z-index: -3;
	      }
	    
        
      </style>
      
  </head>
  <body>
	   <nav>
			<div class="navigation">
			<div>
				<ul class="navigationleftside">
					<li><a href="louisvillefoodsystemfinal.html">Louisville's Food System</a></li>
				</ul>
			</div>
			<div>
				<ul class="navigationrightside">
					<li><a href="overview.html" class="navlinks">Overview</a></li>
					<li><a href="production.html" class="navlinks">Production</a></li>
					<li><a href="manufacturing.html" class="navlinks">Manufacturing</a></li>
					<li><a href="retail.html" class="navlinks">Retail</a></li>
					<li><a href="reform.html" class="navlinks">Reform</a></li>
				</ul>
			</div>
			</div>
		</nav>
	  <div class="component">
	<div id="firstsection">
      <h1>Food Production in Louisville</h1>
	</div>
	<div class="section">
		<p class="part">Most of the food that ends up in Louisville's consumer market isn't actually produced within the city itself, but rather transported via global and national supply chains who in turn source their produce from innumerable (primarily agricultural) enterprises. In this way, Louisville's food system is implicated in the inherent inequalities characterizing broader food systems.<p>
			<p class="part">Some of the <a href="https://agrolearner.com/biggest-agricultural-companies-in-usa/" target="_blank">largest agricultural corporations</a> that likely play a significant role in food production for Louisville include: </p>
		<ol class="part" class="list">
			<li>Cargill</li>
			<li>Syngenta</li>
			<li>Tyson Foods</li>
			<li>BASF</li>
			<li>Nutrien</li>
		</ol>

		<div id="map"></div>
		<div class="buttontext"><button id="toggleCompanies" hidden>Companies</button></div>
	
		<p class="part">Yet there is some food production occurring in Louisville, albeit at a very small scale. According to the United States Department of Agriculture's 2017 "Census," Jefferson County, Kentucky is home to 343 farms with an average acreage of 59 acres per farm. Two of the most prominent forms of agriculture that have became popularized in recent years, particularly in an urban context like Louisville, are community-supported agriculture and community gardening. </p>
</div>
		<div class="section">	
  
      		<h3>Community-Supported Agriculture</h3>
		<p class="part">Community-supported agriculture (known as CSA for short) is a system that allows consumers to subscribe to and support a particular farm of their choosing, in turn being able to share in its produce on a weekly basis. It is a system that is supposed to increase the proximity between food producers and consumers by allowing "both the eater and the grower share the risks and rewards from what comes out of the ground." It has grown in popularity across the U.S., to the point where there are more than 7,000 farms that practice the CSA model all across the country. Some of the factors behind the newfound popularization of CSAs include: the impetus to "eat healthy," the desire to "support local farmers," the perception that such a model could be more sustainable and better for the environment, and the overall notion on the part of both consumers and producers that it's important to get to know where their food is coming from and coming to, respectively (Harper, 2020). Yet CSAs, despite all of their popularization and supposed benefits, have been unevenly distributed with respect to axes of race and income. Because participating in a CSA program requires paying upfront for the farmer's inputs and sharing in the farmer's own losses, CSA members tend to overwhelmingly skew towards privileged sectors of society. </p><br>
		
		<div id="map1" class="part"></div>
     		<div class="buttontext"><button id="toggleCSAs" hidden>CSAs</button></div><br>
		<div class="buttontext"><button id="toggleCSACensusTracts" hidden>Census Tracts</button></div><br>
		<p class="part">In this map (where you can toggle Louisville's CSAs and CSA concentration by census tract), you can see how nearly all farms that have a CSA program are in the relatively privileged Eastern End of the city. The CSA scene in Louisville clearly seems to have a correlation to the most privileged sectors of Louisville's urban fabric, and this comes as no surprise as the same is true in many other urban contexts. </p>
		</div>
	  <div class="section">	
		  <h3>Community Gardening</h3>
		  <p class="part">Community gardening is the practice wherein a small or large group of people, particularly in urban areas, cultivate and harvest produce from a shared gardening space. It is supposed to allow individuals to grow fresh produce on their own plot of land and to induce a degree of localization within the food supply chain. Some of the oft-cited benefits of community gardens and reasons people partake in it include: beautifying the urban landscape, promoting a healthier lifestyle, increasing wellness, and, above all, rupturing the distance between urbanites and the food production process. Yet, as with community supported agriculture, there does seem to be a degree of privilege and financial security involved in community gardening (Tornaghi, 2014; Reynolds, 2014; Ore, 2023). The fact that underprivileged urbanites without the time and resources to maintain upkeep of their own garden are often excluded from community gardening has been growingly recognized in scholarly and popular literature, both in the context of Louisville and beyond.</p>
    <div id="map2" class="part"></div> <!-- Source for help on this: W3Schools -->
     <div class="buttontext"><button id="toggleUrbanFarms" hidden>Urban Farms</button></div>
		
	  
<div class="buttontext"><button id="toggleUrbanFarmHeatmap" hidden>Urban Farms Heatmap</button></div>
		  <div class="buttontext"><button id="toggleUrbanFarmsCensusTracts" hidden>Census Tracts</button></div><br>
<p class="part">In this map (where you can toggle Louisville's urban gardens and urban garden concentration by census tract), you can see how most urban farms are concentrated in the Eastern neighborhoods once more. </p>  
	  </div>
	  </div>

      <script>
        
          var companiesLayer;
	      var companiesVisible = true;
	      var csasLayer;
          var csasVisible = true;
	    var  csascensustractsLayer;
	    var  csascensustractsVisible = true;
         var urbanfarmsLayer;
          var urbanfarmsVisible = true;
	var urbanfarmheatmapLayer;
	      var urbanfarmheatmapVisible = true;
	      var urbanfarmscensustractsLayer;
          var urbanfarmscensustractsVisible = true;
	      
	  var OpenStreetMap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: '© <a href="www.openstreetmap.com/copyright">OpenStreetMap</a>'});

           var CartoDB_DarkMatter = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
	attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
	subdomains: 'abcd',
	maxZoom: 20
});

          

          var USGS_USImageryTopo = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}', {
	        maxZoom: 20,
	        attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
          });

	
	      var Esri_WorldGrayCanvas = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ',
	maxZoom: 16
});

	      var Esri_WorldTerrain = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS',
	maxZoom: 13
});

	      var Esri_WorldShadedRelief = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri',
	maxZoom: 13
});

	      

          var baseMaps = {"OSM" : OpenStreetMap,
			  "CTBD" : CartoDB_DarkMatter,
                          "USGS" : USGS_USImageryTopo,
			  "EWGC": Esri_WorldGrayCanvas,
			  "EWT": Esri_WorldTerrain,
			  "EWSR": Esri_WorldShadedRelief
                         };

	      
         
	       

	     

	 function csaSymbology(feature) {
                var count = feature.properties.NUMPOINTS;
		var polygoncolor;
		 var polygonopacity;

		if (count == 0) {
			polygoncolor = "#FFFFFF";
			polygonopacity = 1;

		}

		if (count == 1) {
			polygoncolor = "#a6bddb";
			polygonopacity = 1;

		}

		return {
		 fillColor: polygoncolor,
		color: polygoncolor,
		fillOpacity: polygonopacity,
		opacity: polygonopacity
			
	       };	       
	      }

	      function urbanfarmsSymbology(feature) {
                var count = feature.properties.NUMPOINTS;
		var polygoncolor;
		var polygonopacity;

		if (count >= 0) {
			polygoncolor = "#FFFFFF";
			polygonopacity = 1;

		}

		if (count >= 1) {
			polygoncolor = "#e5f5f9";
			polygonopacity = 1;

		}

		if (count >= 2) {
			polygoncolor = "#99d8c9";
			polygonopacity = 1;
		}

		if (count >= 3) {
			polygoncolor = "#2ca25f";
			polygonopacity = 1;
		}

		return {
		 fillColor: polygoncolor,
		color: polygoncolor,
		fillOpacity: polygonopacity,
		opacity: polygonopacity
			
	       };	       
	      }

	        var response = $.ajax({
            url: "agriculturalcompanies.geojson",
            dataType: "json",
            success: console.log("Company data loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	    var map = L.map('map', {
		  center: [0, 0],
		  zoom: 1,
		  layers: [Esri_WorldTerrain]
	  });

	       L.control.layers(baseMaps).addTo(map);


	      

          $.when(response).done(function() {
   
            var companiesLayer = L.geoJson(response.responseJSON, {
              
                     onEachFeature: function(feature, layer) {
                            layer.bindPopup("<b>Company: " + 
                            feature.properties.Name + "</b><br>" + feature.properties.Name + ", " + feature.properties.Description + " ," + feature.properties.Issue + "<br>"); 

                       },

                      pointToLayer: function (feature, latlng) { 
                          return L.circleMarker(latlng, {
                            
                         
                          weight: 1,
                          opacity: 1,
			radius: 7,
                          fillOpacity: 1,
                            fillColor: "blue",
                            color: "blue"
              });
              },
            }).addTo(map);

             $("#toggleCompanies").show();

           $("#toggleCompanies").click( function() {
              if (companiesVisible) {
                    companiesVisible = false;
                    companiesLayer.removeFrom(map);
              }

              else {
                  companiesVisible = true;
                   companiesLayer.addTo(map);
              }
            });

          });

                  var response1 = $.ajax({
            url: "CSAs.geojson",
            dataType: "json",
            success: console.log("CSA data loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	      var map1 = L.map('map1', {
		  center: [38.2527, -85.7585],
		  zoom: 10,
		  layers: [OpenStreetMap]
	  });

	 L.control.layers(baseMaps).addTo(map1);

          $.when(response1).done(function() {
   
            var csasLayer = L.geoJson(response1.responseJSON, {
              
                     onEachFeature: function(feature, layer) {
                            layer.bindPopup("<b>CSA: " + 
                            feature.properties.Name + "</b>"); 

                       },

                      pointToLayer: function (feature, latlng) { 
                          return L.circleMarker(latlng, {
                            
                         
                          weight: 1,
                          opacity: 1,
			radius: 3,
                          fillOpacity: 1,
                            fillColor: "blue",
                            color: "blue"
              });
              },
            }).addTo(map1);

             $("#toggleCSAs").show();

           $("#toggleCSAs").click( function() {
              if (csasVisible) {
                    csasVisible = false;
                    csasLayer.removeFrom(map1);
              }

              else {
                  csasVisible = true;
                   csasLayer.addTo(map1);
              }
            });

          });

   var response2 = $.ajax({
            url: "csascensustracts.geojson",
            dataType: "json",
            success: console.log("CSA census data loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	     

          $.when(response2).done(function() {
   
            var csascensustractsLayer = L.geoJson(response2.responseJSON, {

		    style: csaSymbology,
              
                      onEachFeature: function(feature, layer) {
                            layer.bindPopup("In " + 
                            feature.properties.NAME1 + "...<br>" + 
				"There are " + feature.properties.NUMPOINTS + " CSAs<br>" +
				"Meanwhile...<br>" + 
				"The percentage of the population in poverty is " +
				feature.properties.pctpov + "%<br>" +
				"The percentage of the population who is Black and/or Hispanic is " +
				(parseFloat(feature.properties.pctblack) + parseFloat(feature.properties.pcthispani)) + "%<br>" +
				"The percentage of the population who is on SNAP is " +
				feature.properties.pctSNAP + "%"); 
			   

                       }
            }).addTo(map1);

             $("#toggleCSACensusTracts").show();

           $("#toggleCSACensusTracts").click( function() {
              if (csascensustractsVisible) {
                    csascensustractsVisible = false;
                    csascensustractsLayer.removeFrom(map1);
              }

              else {
                  csascensustractsVisible = true;
                   csascensustractsLayer.addTo(map1);
              }
            });

          });
          var response3 = $.ajax({
            url: "urbanfarms2final.geojson",
            dataType: "json",
            success: console.log("Urban farm data loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	       var map2 = L.map('map2', {
		  center: [38.2527, -85.7585],
		  zoom: 10,
		  layers: [OpenStreetMap]
	  });

	      L.control.layers(baseMaps).addTo(map2);
	      

	      var urbanfarmscsv = Array();

          $.when(response3).done(function() {
   
            var urbanfarmsLayer = L.geoJson(response3.responseJSON, {

		   
              
                     onEachFeature: function(feature, layer) {
                            layer.bindPopup("<b>Urban Farm: " + 
                            feature.properties.Name + "</b>"); 
			    urbanfarmscsv.push([feature.geometry.coordinates[1], feature.geometry.coordinates[0], 1]);

                       },

                      pointToLayer: function (feature, latlng) { 
                          return L.circleMarker(latlng, {
                            
                         
                          weight: 1,
                          opacity: 1,
                          fillOpacity: 1,
				  radius: 3,
                            fillColor: "#3BB143",
                            color: "#3BB143"
              });
              },
            }).addTo(map2);

		     console.log(urbanfarmscsv);

      urbanfarmheatmapLayer = L.heatLayer(urbanfarmscsv, {
        radius: 25
      }).addTo(map2);


            $("#toggleUrbanFarms").show();

           $("#toggleUrbanFarms").click( function() {
              if (urbanfarmsVisible) {
                    urbanfarmsVisible = false;
                    urbanfarmsLayer.removeFrom(map2);
              }

              else {
                  urbanfarmsVisible = true;
                   urbanfarmsLayer.addTo(map2);
              }
            });

            $("#toggleUrbanFarmHeatmap").show();

           $("#toggleUrbanFarmHeatmap").click( function() {
              if (urbanfarmheatmapVisible) {
                    urbanfarmheatmapVisible = false;
                    urbanfarmheatmapLayer.removeFrom(map2);
              }

              else {
                  urbanfarmheatmapVisible = true;
                   urbanfarmheatmapLayer.addTo(map2);
              }
            });
	  });


	     var response4 = $.ajax({
            url: "gardensbycensustract.geojson",
            dataType: "json",
            success: console.log("Urban farms by census tract loaded."),
            error: function(xhr) {
              alert(xhr.statusText);
            }
          });

	     

          $.when(response4).done(function() {
   
            var urbanfarmscensustractsLayer = L.geoJson(response4.responseJSON, {

		    style: urbanfarmsSymbology, 
              
                     onEachFeature: function(feature, layer) {
                            layer.bindPopup("In " + 
                            feature.properties.NAME1 + "...<br>" + 
				"There are " + feature.properties.NUMPOINTS + " community gardens<br>" +
				"Meanwhile...<br>" + 
				"The percentage of the population in poverty is " +
				feature.properties.pctpov + "%<br>" +
				"The percentage of the population who is Black and/or Hispanic is " +
				(parseFloat(feature.properties.pctblack) + parseFloat(feature.properties.pcthispani)) + "%<br>" +
				"The percentage of the population who is on SNAP is " +
				feature.properties.pctSNAP + "%"); 
			   

                       }

                    
            }).addTo(map2);



		  
		   $("#toggleUrbanFarmsCensusTracts").show();

           $("#toggleUrbanFarmsCensusTracts").click( function() {
              if (urbanfarmscensustractsVisible) {
                    urbanfarmscensustractsVisible = false;
                    urbanfarmscensustractsLayer.removeFrom(map2);
              }

              else {
                  urbanfarmscensustractsVisible = true;
                   urbanfarmscensustractsLayer.addTo(map2);
              }
            });
	  });

	      

       

	    
   
              
      </script>
  </body>
</html>


