<!DOCTYPE html>
<html>
  <head>
      <title>Hello Campus!</title>
      <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
      <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>'
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
      <script src="urbanfarms.geojson"></script>
      
      <style>
          body {
            background-color: #90DBD1;
          }

          h1 {
            text-align: center;
          }
          #map {
              height: 400px;
              width: 50%;
              margin-left: auto;
              margin-right: auto;
              display: block;
              border-radius: 20px;
            
          }
        
      </style>
      
  </head>
  <body>
      <h1>Hello Campus!</h1>
      <div id="map"></div>
      <div id="buttontext"><button id="toggleFarms">Click to toggle the gardens</button></div>

      <script>
        
          var farmsLayer;
          var farmsVisible = false;
          var map = L.map('map').setView([38.2527, -85.7585], 10);
        
          var OpenStreetMap = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: 'Â© <a href="www.openstreetmap.com/copyright">OpenStreetMap</a>'});

          

          var USGS_USImageryTopo = L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSImageryTopo/MapServer/tile/{z}/{y}/{x}', {
	        maxZoom: 20,
	        attribution: 'Tiles courtesy of the <a href="https://usgs.gov/">U.S. Geological Survey</a>'
          });

          var baseMaps = {"OSM" : OpenStreetMap,
                          "USGS" : USGS_USImageryTopo
                         }

          L.control.layers(baseMaps).addTo(map);

          function pointSymbology(feature) {
                var holisticgentrificationindicator = feature.properties.ChangeMHV + feature.properties.ChangeMHI + feature.properties.ChangeWHP;
                 var color = "#008000;"

                      if (holisticgentrificationindicator > 54.6) {
                            color = "#FF0000";
                      }
                      else {
                            color = "#0000FF";
                      }
                return {
                      fillColor: color,
                }
          }

          
   
            var farmsLayer = L.geoJson(urbanfarms_geojson, {
              
                     onEachFeature: function(feature, layer) {
                            layer.bindPopup("<b>Urban Farm: " + 
                            feature.properties.Name + "</b><br>" + 
                            "Change in Nearby Median Home Values (2018-2023): " + 
                            feature.properties.ChangeMHV + "%" + "<br>" + 
                            "Change in Nearby Median Household Incomes (2018-2023): " + 
                            feature.properties.ChangeMHI + "%" + "<br>" + 
                            "Change in Nearby White Populations (2018-2023): " + 
                            feature.properties.ChangeWHP + "%"); 

                       },

                      pointToLayer: function (feature, latlng) { 
                          return L.circleMarker(latlng, {
                            
                          radius: 8, 
                          fillColor: pointSymbology,
                          color: "#000000",
                          weight: 1,
                          opacity: 1,
                          fillOpacity: 1
              });
              },
            });

           $("#toggleFarms").click( function() {
              if (farmsVisible) {
                    farmsVisible = false;
                    farmsLayer.removeFrom(map);
		    
              }

              else {
                  farmsVisible = true;
                  farmsLayer.addTo(map);
		
              }
            });
              
      </script>
  </body>
</html>
